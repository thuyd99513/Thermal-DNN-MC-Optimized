# 论文实验1 (Figure 1b) 关键参数对比分析

## 论文中的实验设置

根据论文第2页 Figure 1 说明和附录 A-C：

### 模拟方法
论文使用 **GPU加速的分子动力学 (MD) 模拟**，基于 Langevin 动力学，使用 PyTorch 自动微分计算力。

### 网络参数 (论文)
| 参数 | 值 | 说明 |
|------|-----|------|
| L (层数) | 10 | 固定 |
| M (样本数) | 2000 | 固定 |
| N (每层神经元数) | 5, 10, 20, 40 | 变化以改变 ln α |
| N_0 (输入层) | 784 | MNIST 28×28 像素 |
| N_L (输出层) | 2 | 二分类 |
| ln α 范围 | 3.9 ~ 6.0 | α = M/N |

### 模拟参数 (论文)
| 参数 | 值 | 说明 |
|------|-----|------|
| T (温度) | 10^-5 | 极低温 |
| β (逆温度) | 10^5 | β = 1/(k_B T), k_B = 1 |
| t_w (等待时间) | 5 × 10^4 | MD 时间单位 |
| t* (最大模拟时间) | 5 × 10^5 | MD 时间单位 |
| N_s (样本数) | 8 | 独立初始配置 |
| N_r (副本数) | 6-40 | 每个样本的副本数 |

### 测量物理量
论文测量 q_l* ≡ q_l(t = t*)，即层 l 的副本重叠参数在最大模拟时间 t* 时的值。
相变边界定义为 q* ≈ 1/e ≈ 0.368。

### 结果展示
Figure 1b 显示数值相图，颜色编码表示 q_l* 值：
- 横轴: 层 l (1-9)
- 纵轴: ln α (3.9-6.0)
- 颜色: 0.2 (蓝/液态) 到 0.8 (红/固态)

## 关键发现
论文观察到边界层 (l=1,2 和 l=8,9) 为固态，中间层 (l=3-7) 为液态，形成 "固-液-固" 分层结构。


---

## 项目中的实验1实现

根据 `py_functions/run_experiment1_v2.py` 代码：

### 模拟方法
项目使用 **蒙特卡洛 (MC) 模拟**，基于 Metropolis 算法，使用 Numba JIT 加速。

### 网络参数 (项目)
| 参数 | 值 | 说明 |
|------|-----|------|
| L (层数) | 10 | 与论文一致 |
| M (样本数) | 100 | **论文的 1/20** |
| N (每层神经元数) | 3, 5, 10, 20 | 与论文不同 |
| N_0 (输入层) | 784 | 与论文一致 |
| N_L (输出层) | 2 | 与论文一致 |
| ln α 范围 | 1.6 ~ 3.5 | **低于论文的 3.9-6.0** |

### 模拟参数 (项目)
| 参数 | 值 | 说明 |
|------|-----|------|
| β (逆温度) | 10^5 | 与论文一致 |
| MC steps | 50,000 | **远少于论文的 5×10^5** |
| 副本数 | 3 | **少于论文的 6-40** |
| 独立样本数 | 1 | **少于论文的 8** |

---

## 对比分析总结

### 主要差异

| 方面 | 论文 | 项目实现 | 差异程度 |
|------|------|----------|----------|
| **模拟方法** | MD (分子动力学) | MC (蒙特卡洛) | **根本不同** |
| **M (样本数)** | 2000 | 100 | **20倍差距** |
| **模拟步数** | 5×10^5 | 5×10^4 | **10倍差距** |
| **ln α 范围** | 3.9-6.0 | 1.6-3.5 | **范围不重叠** |
| **副本数** | 6-40 | 3 | **2-13倍差距** |
| **独立样本** | 8 | 1 | **8倍差距** |

### 结论

项目中的实验1是 **大幅简化的版本**，主要简化体现在：

1. **模拟方法不同**：论文使用 GPU 加速的 MD 模拟（Langevin 动力学），项目使用 CPU 上的 MC 模拟（Metropolis 算法）。两种方法在物理上应该给出相同的平衡态结果，但动力学行为可能不同。

2. **规模大幅缩小**：样本数从 2000 减少到 100（20倍），模拟步数从 5×10^5 减少到 5×10^4（10倍）。

3. **参数范围不同**：ln α 范围从论文的 3.9-6.0 降低到 1.6-3.5，这意味着项目探索的是不同的参数区域。

4. **统计精度降低**：副本数从 6-40 减少到 3，独立样本从 8 减少到 1，导致统计误差更大。

### 定性结果验证

尽管存在上述简化，项目报告显示仍然观察到了论文的核心现象：
- 边界层（层1）表现出固态行为
- 中间层表现出液态行为
- 层重叠参数随 ln α 变化的趋势与论文一致

但由于参数范围不同，无法直接与论文 Figure 1b 进行定量比较。
